"use strict";const nitEmpresa=document.querySelector("#nit"),owner=document.querySelector("#owner"),nameClient=document.querySelector("#name"),email=document.querySelector("#email"),phone=document.querySelector("#phone"),address=document.querySelector("#address"),_csrfToken=document.getElementsByName("_csrfToken"),add=document.querySelector("#add");async function searchNitBusiness(e){const a=`${window.location.protocol}//${window.location.hostname}/business/searchBussines?nit=${e}`,o=await fetch(a);"error"===await o.json()?(Swal.fire("Error","La empresa registrada ya existe","error",nitEmpresa.focus()),add.disabled=!0):add.disabled=!1}nitEmpresa.addEventListener("change",e=>{searchNitBusiness(e.target.value)}),(async()=>{add.addEventListener("click",async e=>{const a=new FormData;if(a.append("owner_id",owner.value),a.append("name",nameClient.value),a.append("nit",nitEmpresa.value),a.append("phone",phone.value),a.append("address",address.value),a.append("email",email.value),e.preventDefault(),""!=owner.value&&""!=nameClient.value&&""!=nitEmpresa&&""!=phone.value&&""!=address.value&&""!=email.value){Swal.fire({title:"Ingresando Datos, por favor espere!",timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{Swal.showLoading()},willClose:()=>{clearInterval(void 0)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")});try{const e=`${window.location.protocol}//${window.location.hostname}/business/add`,o=await fetch(e,{headers:{"X-CSRF-Token":_csrfToken[0].value},method:"POST",body:a});"ok"===await o.json()&&Swal.fire("Exito!","Datos Guardados Correctamente!","success").then(e=>{e.isConfirmed&&(Swal.fire({title:"Redireccionando, por favor espere!",timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,didOpen:()=>{Swal.showLoading()},willClose:()=>{clearInterval(void 0)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")}),window.location.replace(`${window.location.protocol}//${window.location.hostname}/business/`))})}catch(e){console.error(e),Swal.fire("Ups!","Hubo un error al ingresar los datos :(","error")}}else Swal.fire("Alerta!","Ningun campo tiene que estar vacio!!","error")})})();