"use strict";const id=document.querySelector("#id"),nquote=document.querySelector("#nquote"),valuequote=document.querySelector("#valuequote"),date=document.querySelector("#date"),destiny=document.querySelector("#destiny"),bank=document.querySelector("#bank"),pay=document.querySelector("#pay"),reference=document.querySelector("#reference"),ver=document.querySelector("#ver"),wallet=document.querySelector("#wallet"),_csrfToken=document.getElementsByName("_csrfToken");function generatepay(e,a){pay.addEventListener("click",async o=>{o.preventDefault();const t=new FormData;t.append("agreement_id",id.value),t.append("paymentquote",nquote.value),t.append("cop",valuequote.value),t.append("datepayment",date.value),t.append("destiny_id",destiny.value),t.append("bank_id",bank.value),t.append("trm",e),t.append("valuequote",a),t.append("referencepay",reference.value),Swal.fire({title:"Insertando el pago, por favor espere!",timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,allowEnterKey:!1,didOpen:()=>{Swal.showLoading()},willClose:()=>{clearInterval(void 0)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")});try{const e=`${window.location.protocol}//${window.location.hostname}/payments/add?agreement=${id.value}`,a=await fetch(e,{headers:{"X-CSRF-Token":_csrfToken[0].value},method:"POST",body:t});"ok"===await a.json()&&Swal.fire("Exito!!","Pago Agregado con Exito!!","success").then(e=>{e.isConfirmed&&window.location.replace(`${window.location.protocol}//${window.location.hostname}/wallets/view/${id.value}`)})}catch(e){console.error(e),Swal.fire("Ups!!","Hubo un error al agregar el pago","error")}})}date.addEventListener("change",async e=>{const a=await fetch("https://www.datos.gov.co/resource/x76j-2zn8.json"),o=await a.json();try{const e=o.filter(e=>e.vigenciadesde===date.value+"T00:00:00.000")[0].valor,a=parseInt(valuequote.value)/parseFloat(e);generatepay(e,a.toFixed(3))}catch(e){console.log("No hay datos disponibles"),Swal.fire("Ups!!","No hay datos de TRM disponibles para esta fecha","error")}});