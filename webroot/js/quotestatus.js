const confirmed=document.querySelector("#confirmed"),canceled=document.querySelector("#canceled"),quoteid=document.querySelector("#quoteid").value;async function confirmedquote(t,o){try{const e=new FormData;e.append("quote_id",t),e.append("status_id",o);const a=`${window.location.protocol}//${window.location.hostname}/quotestatuses/add`,n=await fetch(a,{method:"POST",body:e});if("exito"===await n.json())try{Swal.fire({title:"Ingrese el Numero de Factura relacionada a la cotizacion",input:"number",inputAttributes:{autocapitalize:"off"},showDenyButton:!0,confirmButtonText:"Confirmar",showLoaderOnConfirm:!0,denyButtonText:"Cancelar",allowOutsideClick:!1,preConfirm:o=>fetch(`${window.location.protocol}//${window.location.hostname}/quotestatuses/comment?invoice=${o}&quote=${t}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).catch(t=>{Swal.showValidationMessage("Ocurrio un error: "+t)}),allowOutsideClick:()=>!Swal.isLoading()}).then(t=>{t.isConfirmed?Swal.fire({icon:"success",title:"Exito!!",text:"Cotizacion Actualizada Correctamente",confirmButtonText:"Ok",allowOutsideClick:!1}).then(t=>{t.isConfirmed&&updateStatus(o)}):t.isDenied&&(Swal.fire("Cambios no Guardados","","error"),deleteupdatestatus())})}catch(t){Swal.fire("Ups! Algo Fallo","Tu solicitud no fue enviada correctamente, Por favor Intenta nuevamente mas tarde","error")}}catch(t){Swal.fire("Ups! Algo Fallo","Tu solicitud no fue enviada correctamente, Por favor Intenta nuevamente mas tarde","error")}}async function canceledQuote(t,o){const e=new FormData;e.append("quote_id",t),e.append("status_id",o);const a=`${window.location.protocol}//${window.location.hostname}/quotestatuses/add`,n=await fetch(a,{method:"POST",body:e});"exito"===await n.json()&&Swal.fire({title:"Ingrese la razon por la cual la cotizacion no fue apta",input:"textarea",inputAttributes:{autocapitalize:"off"},showDenyButton:!0,confirmButtonText:"Confirmar",showLoaderOnConfirm:!0,denyButtonText:"Cancelar",allowOutsideClick:!1,preConfirm:o=>fetch(`${window.location.protocol}//${window.location.hostname}/quotestatuses/noapta?comment=${o}&quote=${t}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).catch(t=>{Swal.showValidationMessage("Ocurrio un error: "+t)}),allowOutsideClick:()=>!Swal.isLoading()}).then(t=>{t.isConfirmed?Swal.fire({icon:"success",title:"Exito!!",text:"Cotizacion Actualizada Correctamente",confirmButtonText:"Ok",allowOutsideClick:!1}).then(t=>{t.isConfirmed&&updateStatus(o)}):t.isDenied&&(Swal.fire("Cambios no Guardados","","error"),deleteupdatestatus())})}async function updateStatus(t){const o=`${window.location.protocol}//${window.location.hostname}/quotes/changestatus?quote=${quoteid}&status=${t}`,e=await fetch(o);"ok"===await e.json()&&window.location.reload()}async function deleteupdatestatus(){const t=`${window.location.protocol}//${window.location.hostname}/quotestatuses/deletestatus?quote=${quoteid}`;"ok"===(await fetch(t)).json()&&Window.location.reload()}confirmed.addEventListener("click",()=>{confirmedquote(quoteid,1)}),canceled.addEventListener("click",()=>{canceledQuote(quoteid,3)});