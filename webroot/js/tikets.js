"use strict";const serial=document.querySelector("#serial"),submit=document.querySelector("#submit"),email=document.querySelector("#email"),phone=document.querySelector("#phone"),comments=document.querySelector("#comments"),change=document.getElementsByClassName("change"),support=document.querySelector("#support"),nameClient=document.querySelector("#nameClient"),userid=document.querySelector("#userid");function generateSubmit(e=""){submit.addEventListener("click",async t=>{t.preventDefault();const a=new FormData;let o;a.append("machine_id",e),a.append("email",email.value),a.append("phone",phone.value),a.append("comments",comments.value),a.append("support_id",support.value),a.append("name_client",nameClient.value),Swal.fire({title:"Generando Ticket",html:"Generando Ticket, por favor espere!",timerProgressBar:!0,didOpen:()=>{Swal.showLoading()},willClose:()=>{clearInterval(o)}}).then(e=>{e.dismiss===Swal.DismissReason.timer&&console.log("I was closed by the timer")});try{const e=`${window.location.protocol}//${window.location.hostname}/tikets/add`,t=await fetch(e,{method:"POST",body:a});"ok"===await t.json()&&Swal.fire({title:"Ticket Generado",text:"Tu solicitud ha sido generada con exito, pronto nuestra area tecnica se comunicara contigo",icon:"success"}).then(e=>{e.isConfirmed&&(window.location.replace("https://alfastreet.co/"),Swal.fire({title:"Redireccionando",html:"Por favor espere, sera redireccionado a la pagina principal",allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{Swal.showLoading();const e=Swal.getHtmlContainer().querySelector("b");o=setInterval(()=>{e.textContent=Swal.getTimerLeft()},100)},willClose:()=>{clearInterval(o)}}))})}catch(e){Swal.fire("Ups! Algo Fallo","Tu solicitud no fue enviada correctamente, Por favor Intenta nuevamente mas tarde","error")}})}async function searchSerial(e){}(async()=>{serial.addEventListener("focusout",async e=>{const t=e.target.value;try{const e=`${window.location.protocol}//${window.location.hostname}/machines/search?serial=${t}`,a=await fetch(e),o=await a.json();if(o){submit.disabled=!1,generateSubmit(o.id)}else Swal.fire("Error","La maquina no esta registrada, por favor contacte con su comercial","error"),submit.disabled=!0}catch(e){Swal.fire("Error","Hubo un error al generar el Ticket, intenta de nuevo mas tarde","error")}})})(),(async()=>{try{support.addEventListener("change",e=>{1!=e.target.value?(serial.disabled=!0,generateSubmit()):serial.disabled=!1})}catch(e){}})(),(async()=>{try{for(let e=0;e<change.length;e++)change[e].addEventListener("click",async t=>{t.preventDefault();const a=change[e].value,{value:o}=await Swal.fire({title:"Por que medio se resolvio el ticket",input:"select",inputOptions:{"":"Seleccione una opcion","No fisicos":{telefono:"Via Telefonica (Max 15 Minutos)",whatsaap:"Via Whatsapp",cotizacion:"Se generara una cotizacion"},"Visita Tecnica":{orden:"Se requiere una visita tecnica"}},showCancelButton:!0,allowOutsideClick:!1,inputValidator:e=>{if(!e)return"Seleccione una Opcion Valida!"}});if(o){const e=`${window.location.protocol}//${window.location.hostname}/tikets/updatetiket?id=${a}&resolved=${o}&userid=${userid.value}`;Swal.fire({title:`Se actualizo el Ticket ${a}, se resolvio via: ${o}`,allowOutsideClick:!1}).then(async t=>{try{if(t.isConfirmed){const t=await fetch(e);"ok"===await t.json()&&(window.location.reload(),Swal.fire({title:"Redireccionando",html:"Por favor espere, sera redireccionado a la pagina principal",allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{Swal.showLoading();const e=Swal.getHtmlContainer().querySelector("b");timerInterval=setInterval(()=>{e.textContent=Swal.getTimerLeft()},100)},willClose:()=>{clearInterval(timerInterval)}}))}}catch(e){console.error(e)}})}})}catch(e){}})();