"use strict";const serial=document.querySelector("#serial"),submit=document.querySelector("#submit"),email=document.querySelector("#email"),phone=document.querySelector("#phone"),comments=document.querySelector("#comments"),change=document.getElementsByClassName("change"),support=document.querySelector("#support"),nameClient=document.querySelector("#nameClient"),userid=document.querySelector("#userid");function generateSubmit(e=""){submit.addEventListener("click",t=>{t.preventDefault(),Swal.fire({title:"Ticket Generado",text:"Tu solicitud ha sido generada con exito, pronto nuestra area tecnica se comunicara contigo",icon:"success"}).then(t=>{t.isConfirmed&&submitData(e)})})}async function searchSerial(e){const t=`${window.location.protocol}//${window.location.hostname}/machines/search?serial=${e}`,a=await fetch(t),i=await a.json();if(i){submit.disabled=!1,generateSubmit(i.id)}else Swal.fire("Error","La maquina no esta registrada, por favor contacte con su comercial","error"),submit.disabled=!0}async function submitData(e=0){const t=new FormData;t.append("machine_id",e),t.append("email",email.value),t.append("phone",phone.value),t.append("comments",comments.value),t.append("support_id",support.value),t.append("name_client",nameClient.value);try{const e=`${window.location.protocol}//${window.location.hostname}/tikets/add`,a=await fetch(e,{method:"POST",body:t});"ok"===await a.json()&&(window.location.replace("https://alfastreet.co/"),Swal.fire({title:"Redireccionando",html:"Por favor espere, sera redireccionado a la pagina principal",allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{Swal.showLoading();const e=Swal.getHtmlContainer().querySelector("b");timerInterval=setInterval(()=>{e.textContent=Swal.getTimerLeft()},100)},willClose:()=>{clearInterval(timerInterval)}}))}catch(e){console.error(e)}}(async()=>{try{serial.addEventListener("focusout",e=>{searchSerial(e.target.value)})}catch(e){}})(),(async()=>{try{support.addEventListener("change",e=>{1!=e.target.value?(serial.disabled=!0,generateSubmit()):serial.disabled=!1})}catch(e){}})(),(async()=>{try{for(let e=0;e<change.length;e++)change[e].addEventListener("click",async t=>{t.preventDefault();const a=change[e].value,{value:i}=await Swal.fire({title:"Por que medio se resolvio el ticket",input:"select",inputOptions:{"":"Seleccione una opcion","No fisicos":{telefono:"Via Telefonica (Max 15 Minutos)",whatsaap:"Via Whatsapp",cotizacion:"Se generara una cotizacion"},"Visita Tecnica":{orden:"Se requiere una visita tecnica"}},showCancelButton:!0,allowOutsideClick:!1,inputValidator:e=>{if(!e)return"Seleccione una Opcion Valida!"}});if(i){const e=`${window.location.protocol}//${window.location.hostname}/tikets/updatetiket?id=${a}&resolved=${i}&userid=${userid.value}`;Swal.fire({title:`Se actualizo el Ticket ${a}, se resolvio via: ${i}`,allowOutsideClick:!1}).then(async t=>{try{if(t.isConfirmed){const t=await fetch(e);"ok"===await t.json()&&(window.location.reload(),Swal.fire({title:"Redireccionando",html:"Por favor espere, sera redireccionado a la pagina principal",allowOutsideClick:!1,timerProgressBar:!0,didOpen:()=>{Swal.showLoading();const e=Swal.getHtmlContainer().querySelector("b");timerInterval=setInterval(()=>{e.textContent=Swal.getTimerLeft()},100)},willClose:()=>{clearInterval(timerInterval)}}))}}catch(e){console.error(e)}})}})}catch(e){}})();